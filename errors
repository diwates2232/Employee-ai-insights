import React, { useEffect, useState } from 'react';
import SummaryChart from './components/SummaryChart';
import ZoneDetailsTable from './components/ZoneDetailsTable';
import './App.css';

function App() {
  const [summaryData, setSummaryData] = useState([]);
  const [detailsData, setDetailsData] = useState({});

  useEffect(() => {
    fetch('http://localhost:5000/api/live-occupancy')
      .then(res => res.json())
      .then(payload => {
        setSummaryData(payload.summary || []);
        setDetailsData(payload.details || {});
      })
      .catch(err => console.error('Occupancy fetch error:', err));
  }, []);

  return (
    <div className="App">
      <header className="App-header">
        <h1>Live Occupancy Dashboard</h1>
      </header>
      <main>
        <section>
          <h2>Occupancy Summary</h2>
          <SummaryChart summary={summaryData} /> {/* FIXED PROP */}
        </section>
        <section>
          <h2>Zone Details</h2>
          <ZoneDetailsTable data={detailsData} />
        </section>
      </main>
    </div>
  );
}

export default App;




import React from 'react';

function ZoneDetailsTable({ data = {} }) {
  if (!data || typeof data !== 'object') {
    return <p>No zone detail data available.</p>;
  }

  const entries = Object.entries(data);

  if (entries.length === 0) {
    return <p>No zone detail data available.</p>;
  }

  return (
    <div className="zone-details-table">
      {entries.map(([zone, employees]) => (
        <section key={zone}>
          <h3>{zone}</h3>
          <table>
            <thead>
              <tr>
                <th>EmployeeID</th>
                <th>Name</th>
                <th>Swipe Time</th>
              </tr>
            </thead>
            <tbody>
              {(employees || []).map(emp => (
                <tr key={`${emp.EmployeeID}-${emp.Swipe_Time}`}>
                  <td>{emp.EmployeeID}</td>
                  <td>{emp.ObjectName1}</td>
                  <td>{emp.Swipe_Time}</td>
                </tr>
              ))}
            </tbody>
          </table>
        </section>
      ))}
    </div>
  );
}

export default ZoneDetailsTable;












let check all File details And find root cause and give me updated js file carefully.

// src/components/ZoneDetailsTable.js

import React from 'react';

function ZoneDetailsTable({ data = {} }) {
  // Ensure we always have an object
  const entries = Object.entries(data || {});

  if (entries.length === 0) {
    return <p>No zone detail data available.</p>;
  }

  return (
    <div className="zone-details-table">
      {entries.map(([zone, employees]) => (
        <section key={zone}>
          <h3>{zone}</h3>
          <table>
            <thead>
              <tr>
                <th>EmployeeID</th>
                <th>Name</th>
                <th>Swipe Time</th>
                {/* add other headers as needed */}
              </tr>
            </thead>
            <tbody>
              {employees.map(emp => (
                <tr key={emp.EmployeeID + emp.Swipe_Time}>
                  <td>{emp.EmployeeID}</td>
                  <td>{emp.ObjectName1}</td>
                  <td>{emp.Swipe_Time}</td>
                  {/* add other cells as needed */}
                </tr>
              ))}
            </tbody>
          </table>
        </section>
      ))}
    </div>
  );
}

export default ZoneDetailsTable;






file 2

Summarycharts.js

import React from 'react';
import {
  BarChart,
  Bar,
  XAxis,
  YAxis,
  Tooltip,
  CartesianGrid,
  ResponsiveContainer
} from 'recharts';

const SummaryChart = ({ summary }) => (
  <div className="mb-5">
    <h4>Zone-wise Occupancy</h4>
    <ResponsiveContainer width="100%" height={300}>
      <BarChart data={summary}>
        <CartesianGrid strokeDasharray="3 3" />
        <XAxis dataKey="zone" />
        <YAxis allowDecimals={false} />
        <Tooltip />
        <Bar dataKey="count" fill="#007bff" />
      </BarChart>
    </ResponsiveContainer>
  </div>
);

export default SummaryChart;



App.js




// src/App.js

import React, { useEffect, useState } from 'react';
import SummaryChart from './components/SummaryChart';
import ZoneDetailsTable from './components/ZoneDetailsTable';
import './App.css';

function App() {
  const [summaryData, setSummaryData] = useState([]);
  const [detailsData, setDetailsData] = useState({});

  useEffect(() => {
    // Fetch the combined occupancy payload from your Express endpoint
    fetch('http://localhost:5000/api/live-occupancy')              
      .then(res => res.json())
      .then(payload => {
        setSummaryData(payload.summary || []);
        setDetailsData(payload.details || {});
      })
      .catch(err => console.error('Occupancy fetch error:', err));
  }, []);

  return (
    <div className="App">
      <header className="App-header">
        <h1>Live Occupancy Dashboard</h1>
      </header>
      <main>
        <section>
          <h2>Occupancy Summary</h2>
          <SummaryChart data={summaryData} />
        </section>
        <section>
          <h2>Zone Details</h2>
          <ZoneDetailsTable data={detailsData} />
        </section>
      </main>
    </div>
  );
}

export default App;




