const path = require('path');
const xlsx = require('xlsx');

// 1. Load the workbook & first sheet
const filePath = path.join(__dirname, '..', 'data', 'doorDenver.xlsx');
const workbook = xlsx.readFile(filePath);
const sheet = workbook.Sheets[workbook.SheetNames[0]];

// 2. Convert to JSON
const rows = xlsx.utils.sheet_to_json(sheet);
if (!rows.length) {
  console.error('No rows found in doorDenver.xlsx');
  process.exit(1);
}
console.log(`Read ${rows.length} rows from doorDenver.xlsx`);

// 3. Build the door→floor map
const doorFloorMap = {};

const DOOR_COLUMN = 'Door Name';
const IN_DIR_COLUMN = 'IN Direction';
const IN_FLOOR_COLUMN = 'IN Floor';
const OUT_DIR_COLUMN = 'OUT Direction';
const OUT_FLOOR_COLUMN = 'OUT Floor';

function clean(value) {
  return String(value || '').trim().replace(/\s+/g, ' ');
}

rows.forEach(row => {
  const door = clean(row[DOOR_COLUMN]).toUpperCase();
  const inDir = clean(row[IN_DIR_COLUMN]).toUpperCase();
  const outDir = clean(row[OUT_DIR_COLUMN]).toUpperCase();
  const inFloor = clean(row[IN_FLOOR_COLUMN]);
  const outFloor = clean(row[OUT_FLOOR_COLUMN]);

  if (door && inDir && inFloor) {
    doorFloorMap[`${door}___${inDir}`] = inFloor;
  }
  if (door && outDir && outFloor) {
    doorFloorMap[`${door}___${outDir}`] = outFloor;
  }
});

// 4. Print the object to console
console.log('\n--- COPY FROM BELOW ---\n');
console.log('// Auto-generated from data/doorDenver.xlsx');
console.log('module.exports = ' + JSON.stringify(doorFloorMap, null, 2) + ';');
console.log('\n--- COPY UNTIL HERE ---');
console.log(`\nTotal entries: ${Object.keys(doorFloorMap).length}`);








const fs = require('fs');
const path = require('path');
const xlsx = require('xlsx');

// Load Excel
const inputFilePath = path.join(__dirname, '..', 'data', 'doorDenver.xlsx');
const outputFilePath = path.join(__dirname, '..', 'data', 'denverDoorFloorMap.js');

// Read workbook
const workbook = xlsx.readFile(inputFilePath);
const sheet = workbook.Sheets[workbook.SheetNames[0]];
const rows = xlsx.utils.sheet_to_json(sheet);

console.log(`Read ${rows.length} rows from doorDenver.xlsx`);

const DOOR_COLUMN = 'Door Name';
const IN_DIR_COLUMN = 'IN Direction';
const IN_FLOOR_COLUMN = 'IN Floor';
const OUT_DIR_COLUMN = 'OUT Direction';
const OUT_FLOOR_COLUMN = 'OUT Floor';

const map = {};

function sanitizeKey(str) {
  return String(str || '')
    .trim()
    .toUpperCase()
    .replace(/\s+/g, ' ')
    .replace(/"/g, '') // remove quotes
    .replace(/[\u200B-\u200D\uFEFF]/g, '') // remove hidden unicode
    .replace(/\\/g, '') // remove backslashes
    .replace(/\r?\n|\r/g, '') // remove newlines
}

function sanitizeValue(str) {
  return String(str || '')
    .trim()
    .replace(/"/g, '')
    .replace(/[\u200B-\u200D\uFEFF]/g, '');
}

rows.forEach((row, index) => {
  const door = sanitizeKey(row[DOOR_COLUMN]);
  const inDir = sanitizeKey(row[IN_DIR_COLUMN]);
  const inFloor = sanitizeValue(row[IN_FLOOR_COLUMN]);
  const outDir = sanitizeKey(row[OUT_DIR_COLUMN]);
  const outFloor = sanitizeValue(row[OUT_FLOOR_COLUMN]);

  if (door && inDir && inFloor) {
    map[`${door}___${inDir}`] = inFloor;
  }
  if (door && outDir && outFloor) {
    map[`${door}___${outDir}`] = outFloor;
  }
});

// Prepare JS export content safely
const fileContent = `// Auto-generated from data/doorDenver.xlsx
module.exports = ${JSON.stringify(map, null, 2)};
`;

try {
  fs.writeFileSync(outputFilePath, fileContent, 'utf8');
  console.log(`Denver door-to-floor map written to: ${outputFilePath}`);
  console.log('Total entries in map:', Object.keys(map).length);
  console.log('\n--- Preview ---\n' + fileContent.slice(0, 500));
} catch (err) {
  console.error('Error writing file:', err);
}




node scripts/generateDenverDoorFloorMap.js








node scripts/generateDenverDoorFloorMap.js


const fs = require('fs');
const path = require('path');
const xlsx = require('xlsx');

// Load Excel
const filePath = path.join(__dirname, '..', 'data', 'doorDenver.xlsx');
const workbook = xlsx.readFile(filePath);
const sheet = workbook.Sheets[workbook.SheetNames[0]];
const rows = xlsx.utils.sheet_to_json(sheet);

if (!rows.length) {
  console.error('No rows found in doorDenver.xlsx');
  process.exit(1);
}

console.log(`Read ${rows.length} rows from doorDenver.xlsx`);

const doorFloorMap = {};

// Column names
const DOOR_COLUMN = 'Door Name';
const IN_DIR_COLUMN = 'IN Direction';
const IN_FLOOR_COLUMN = 'IN Floor';
const OUT_DIR_COLUMN = 'OUT Direction';
const OUT_FLOOR_COLUMN = 'OUT Floor';

// Map logic
rows.forEach((row, index) => {
  const door = String(row[DOOR_COLUMN] || '').trim();
  const inDir = String(row[IN_DIR_COLUMN] || '').trim();
  const inFloor = String(row[IN_FLOOR_COLUMN] || '').trim();
  const outDir = String(row[OUT_DIR_COLUMN] || '').trim();
  const outFloor = String(row[OUT_FLOOR_COLUMN] || '').trim();

  if (!door) {
    console.warn(`Skipping row ${index + 2} (missing Door Name)`);
    return;
  }

  const upperDoor = door.toUpperCase();

  if (inDir && inFloor) {
    doorFloorMap[`${upperDoor}___${inDir}`] = inFloor;
  }

  if (outDir && outFloor) {
    doorFloorMap[`${upperDoor}___${outDir}`] = outFloor;
  }
});

// Output path
const outputDir = path.join(__dirname, '..', 'data');
const outputPath = path.join(outputDir, 'denverDoorFloorMap.js');

// Ensure output directory exists
if (!fs.existsSync(outputDir)) {
  fs.mkdirSync(outputDir, { recursive: true });
}

// Write JS file
const fileContent =
  `// Auto-generated from data/doorDenver.xlsx\n` +
  `module.exports = ${JSON.stringify(doorFloorMap, null, 2)};\n`;

try {
  fs.writeFileSync(outputPath, fileContent, 'utf8');
  console.log('\n✅ Denver door-to-floor map written to:', outputPath);
  console.log('Total entries in map:', Object.keys(doorFloorMap).length);
} catch (err) {
  console.error('❌ Failed to write file:', err.message);
}

// Preview
console.log('\n--- Preview of exported map ---');
console.log(fileContent.slice(0, 500));
console.log('--------------------------------');











const fs = require('fs');
const path = require('path');
const xlsx = require('xlsx');

// 1. Load the workbook & first sheet
const filePath = path.join(__dirname, '..', 'data', 'doorDenver.xlsx');
const workbook = xlsx.readFile(filePath);
const sheet = workbook.Sheets[workbook.SheetNames[0]];

// 2. Convert to JSON
const rows = xlsx.utils.sheet_to_json(sheet);
if (!rows.length) {
  console.error('No rows found in doorDenver.xlsx');
  process.exit(1);
}
console.log(`Read ${rows.length} rows from doorDenver.xlsx`);

// 3. Build the door→floor map
const doorFloorMap = {};

// Excel column headers (adjust if your actual Excel file has different names)
const DOOR_COLUMN = 'Door Name';
const IN_DIR_COLUMN = 'IN Direction';
const IN_FLOOR_COLUMN = 'IN Floor';
const OUT_DIR_COLUMN = 'OUT Direction';
const OUT_FLOOR_COLUMN = 'OUT Floor';

rows.forEach((row, index) => {
  const rawDoor = String(row[DOOR_COLUMN] || '').trim();
  const inDir = String(row[IN_DIR_COLUMN] || '').trim();
  const inFloor = String(row[IN_FLOOR_COLUMN] || '').trim();
  const outDir = String(row[OUT_DIR_COLUMN] || '').trim();
  const outFloor = String(row[OUT_FLOOR_COLUMN] || '').trim();

  if (!rawDoor) {
    console.warn(`Skipping row ${index + 2} (missing Door Name)`);
    return;
  }

  const doorName = rawDoor.toUpperCase();

  if (inDir && inFloor) {
    doorFloorMap[`${doorName}___${inDir}`] = inFloor;
  }

  if (outDir && outFloor) {
    doorFloorMap[`${doorName}___${outDir}`] = outFloor;
  }
});

// 4. Generate output content
const outputPath = path.join(__dirname, '..', 'data', 'denverDoorFloorMap.js');
const content =
  `// Auto-generated from data/doorDenver.xlsx\n` +
  `module.exports = ${JSON.stringify(doorFloorMap, null, 2)};\n`;

// 5. Write file with overwrite mode
try {
  fs.writeFileSync(outputPath, content, { encoding: 'utf8', flag: 'w' });
  console.log('\n✅ Denver door-to-floor map written to:', outputPath);
  console.log('Total entries in map:', Object.keys(doorFloorMap).length);
} catch (err) {
  console.error('❌ Error writing file:', err.message);
}

// 6. Preview first few lines
console.log('\n--- Preview of exported map ---');
console.log(content.slice(0, 500));
console.log('--------------------------------');










const fs = require('fs');
const path = require('path');
const xlsx = require('xlsx');

// 1. Load Excel file
const filePath = path.join(__dirname, '..', 'data', 'doorDenver.xlsx');
const workbook = xlsx.readFile(filePath);
const sheet = workbook.Sheets[workbook.SheetNames[0]];
const rows = xlsx.utils.sheet_to_json(sheet);

if (!rows.length) {
  console.error('No rows found in doorDenver.xlsx');
  process.exit(1);
}

console.log(`Read ${rows.length} rows from doorDenver.xlsx`);

// 2. Build the door-to-floor map
const doorFloorMap = {};
rows.forEach(row => {
  const rawDoor = String(row['Door Name'] || '').trim();
  if (!rawDoor) return; // skip if door name is blank
  const doorName = rawDoor.toUpperCase();

  const inDir = String(row['IN Direction'] || '').trim();
  const inFloor = String(row['IN Floor'] || '').trim();
  if (inDir && inFloor) {
    doorFloorMap[`${doorName}___${inDir}`] = inFloor;
  }

  const outDir = String(row['OUT Direction'] || '').trim();
  const outFloor = String(row['OUT Floor'] || '').trim();
  if (outDir && outFloor) {
    doorFloorMap[`${doorName}___${outDir}`] = outFloor;
  }
});

// 3. Write result to JS file
const outputPath = path.join(__dirname, '..', 'data', 'denverDoorFloorMap.js');
const content = 
  `// Auto-generated from data/doorDenver.xlsx\n` +
  `module.exports = ${JSON.stringify(doorFloorMap, null, 2)};\n`;

fs.writeFileSync(outputPath, content, 'utf8');

console.log('✅ Denver door-to-floor map written to:', outputPath);
console.log('Total entries in map:', Object.keys(doorFloorMap).length);















// scripts/generateDenverDoorFloorMap.js

const fs = require('fs');
const path = require('path');
const xlsx = require('xlsx');

// 1. Load Excel file
const filePath = path.join(__dirname, '..', 'data', 'doorDenver.xlsx');
const workbook = xlsx.readFile(filePath);
const sheet = workbook.Sheets[workbook.SheetNames[0]];
const rows = xlsx.utils.sheet_to_json(sheet);

if (!rows.length) {
  console.error('No rows found in doorDenver.xlsx');
  process.exit(1);
}

console.log(`Read ${rows.length} rows from doorDenver.xlsx`);

// 2. Build the map
const doorFloorMap = {};
const DOOR_COLUMN = 'Door Name';
const IN_DIR_COLUMN = 'IN Direction';
const IN_FLOOR_COLUMN = 'IN Floor';
const OUT_DIR_COLUMN = 'OUT Direction';
const OUT_FLOOR_COLUMN = 'OUT Floor';

rows.forEach(row => {
  const rawDoor = String(row[DOOR_COLUMN] || '').trim();
  const doorName = rawDoor.toUpperCase();

  const inDirection = String(row[IN_DIR_COLUMN] || '').trim();
  const inFloor = String(row[IN_FLOOR_COLUMN] || '').trim();

  const outDirection = String(row[OUT_DIR_COLUMN] || '').trim();
  const outFloor = String(row[OUT_FLOOR_COLUMN] || '').trim();

  if (!doorName) {
    console.warn('Skipping row (missing Door Name):', row);
    return;
  }

  if (inDirection && inFloor) {
    doorFloorMap[`${doorName}___${inDirection}`] = inFloor;
  }

  if (outDirection && outFloor) {
    doorFloorMap[`${doorName}___${outDirection}`] = outFloor;
  }
});

// 3. Write output
const outputPath = path.join(__dirname, '..', 'data', 'denverDoorFloorMap.js');
const content =
  `// Auto-generated from data/doorDenver.xlsx\n` +
  `module.exports = ${JSON.stringify(doorFloorMap, null, 2)};\n`;

fs.writeFileSync(outputPath, content, 'utf8');

console.log('✅ Denver door-to-floor map written to:', outputPath);
console.log('Total entries in map:', Object.keys(doorFloorMap).length);






node scripts/generateDenverDoorFloorMap.js









// scripts/generateDenverDoorFloorMap.js

const fs = require('fs');
const path = require('path');
const xlsx = require('xlsx');

// 1. Load the workbook & first sheet
const filePath = path.join(__dirname, '..', 'data', 'doorDenver.xlsx');
const workbook = xlsx.readFile(filePath);
const sheet = workbook.Sheets[workbook.SheetNames[0]];

// 2. Convert to JSON
const rows = xlsx.utils.sheet_to_json(sheet);
if (!rows.length) {
  console.error('No rows found in doorDenver.xlsx');
  process.exit(1);
}
console.log(`Read ${rows.length} rows from doorDenver.xlsx`);

// 3. Build the door→floor map
const doorFloorMap = {};

// Column headers
const DOOR_COLUMN = 'Door Name';
const IN_DIR_COLUMN = 'IN Direction';
const IN_FLOOR_COLUMN = 'IN Floor';
const OUT_DIR_COLUMN = 'OUT Direction';
const OUT_FLOOR_COLUMN = 'OUT Floor';

rows.forEach(row => {
  const rawDoor = String(row[DOOR_COLUMN] || '').trim();
  const inDir = String(row[IN_DIR_COLUMN] || '').trim();
  const inFloor = String(row[IN_FLOOR_COLUMN] || '').trim();
  const outDir = String(row[OUT_DIR_COLUMN] || '').trim();
  const outFloor = String(row[OUT_FLOOR_COLUMN] || '').trim();

  if (!rawDoor) {
    console.warn('Skipping row (missing Door Name):', row);
    return;
  }

  const doorName = rawDoor.toUpperCase();

  if (inDir && inFloor) {
    doorFloorMap[`${doorName}___${inDir}`] = inFloor;
  }

  if (outDir && outFloor) {
    doorFloorMap[`${doorName}___${outDir}`] = outFloor;
  }
});

// 4. Write out the JS file
const outputPath = path.join(__dirname, '..', 'data', 'denverDoorFloorMap.js');
const content = 
  `// Auto-generated from data/doorDenver.xlsx\n` +
  `module.exports = ${JSON.stringify(doorFloorMap, null, 2)};\n`;

fs.writeFileSync(outputPath, content, 'utf8');

console.log('✅ Denver door-to-floor map written to:', outputPath);
console.log('Total entries in map:', Object.keys(doorFloorMap).length);









// scripts/generateDenverDoorFloorMap.js

const fs = require('fs');
const path = require('path');
const xlsx = require('xlsx');

// 1. Load the workbook & first sheet
const filePath = path.join(__dirname, '..', 'data', 'doorDenver.xlsx');
const workbook = xlsx.readFile(filePath);
const sheet = workbook.Sheets[workbook.SheetNames[0]];

// 2. Convert to JSON
const rows = xlsx.utils.sheet_to_json(sheet);
if (!rows.length) {
  console.error('No rows found in doorDenver.xlsx');
  process.exit(1);
}
console.log(`Read ${rows.length} rows from doorDenver.xlsx`);

// 3. Build the door→floor map
const doorFloorMap = {};

// Replace these with your actual column names in the Excel file
const DOOR_COLUMN = 'Door Name';
const IN_DIR_COLUMN = 'IN Direction';
const OUT_DIR_COLUMN = 'OUT Direction';
const FLOOR_COLUMN = 'Floor';

rows.forEach(row => {
  const rawDoor = String(row[DOOR_COLUMN] || '').trim();
  const inDirKey = String(row[IN_DIR_COLUMN] || '').trim();
  const outDirKey = String(row[OUT_DIR_COLUMN] || '').trim();
  const floor = String(row[FLOOR_COLUMN] || '').trim();

  if (!rawDoor || !floor) {
    console.warn('Skipping row (missing Door Name or Floor):', row);
    return;
  }

  const doorName = rawDoor.toUpperCase();

  if (inDirKey) {
    doorFloorMap[`${doorName}___${inDirKey}`] = floor;
  }
  if (outDirKey) {
    doorFloorMap[`${doorName}___${outDirKey}`] = floor;
  }
});

// 4. Write out the JS file
const outputPath = path.join(__dirname, '..', 'data', 'denverDoorFloorMap.js');
const content = 
  `// Auto-generated from data/doorDenver.xlsx\n` +
  `module.exports = ${JSON.stringify(doorFloorMap, null, 2)};\n`;

fs.writeFileSync(outputPath, content, 'utf8');

console.log('✅ Denver door-to-floor map written to:', outputPath);
console.log('Total entries in map:', Object.keys(doorFloorMap).length);

