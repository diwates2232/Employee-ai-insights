    if col not in df_merged.columns:
        # Create a new BooleanDtype column filled with pd.NA
        df_merged[col] = pd.Series(pd.NA, index=df_merged.index, dtype="boolean")
    else:
        # First cast whatever’s there to BooleanDtype, then fill missing with False
        df_merged[col] = df_merged[col].astype("boolean")
    df_merged[col] = df_merged[col].fillna(False)











PS C:\Users\W0024618\Desktop\ai-employee-security\src> python train.py
⏱️  Detected timestamp column: 'LocaleMessageTime'
C:\Users\W0024618\Desktop\ai-employee-security\src\extract.py:40: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df["LocaleMessageTime"] = pd.to_datetime(
C:\Users\W0024618\Desktop\ai-employee-security\src\train.py:88: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df_merged[col] = df_merged[col].fillna(False).astype("boolean")

[Classification Report on Test Set]
              precision    recall  f1-score   support

           0       1.00      1.00      1.00     44371
           1       1.00      1.00      1.00     17736

    accuracy                           1.00     62107
   macro avg       1.00      1.00      1.00     62107
weighted avg       1.00      1.00      1.00     62107

✅ Model saved to: C:\Users\W0024618\Desktop\ai-employee-security\models\rf_model.joblib
PS C:\Users\W0024618\Desktop\ai-employee-security\src> 
