import warnings
warnings.simplefilter(action='ignore', category=FutureWarning)






# Ensure every label column exists and is BooleanDtype
    label_columns = [
        "anomaly",
        "card_share",
        "simultaneous",
        "one_swipe",
        "two_swipe",
        "exit_first",
        "short_stay",
        "long_stay",
    ]

    for col in label_columns:
        # If missing, add the column with proper BooleanDtype
        if col not in df_merged.columns:
            df_merged[col] = pd.Series([False] * len(df_merged), dtype="boolean")
        else:
            # Ensure dtype is correct before filling
            df_merged[col] = df_merged[col].astype("boolean").fillna(False)












PS C:\Users\W0024618\Desktop\ai-employee-security\src> python train.py
⏱️  Detected timestamp column: 'LocaleMessageTime'
C:\Users\W0024618\Desktop\ai-employee-security\src\extract.py:40: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df["LocaleMessageTime"] = pd.to_datetime(

[Classification Report on Test Set]
              precision    recall  f1-score   support

           0       1.00      1.00      1.00     44371
           1       1.00      1.00      1.00     17736

    accuracy                           1.00     62107
   macro avg       1.00      1.00      1.00     62107
weighted avg       1.00      1.00      1.00     62107

✅ Model saved to: C:\Users\W0024618\Desktop\ai-employee-security\models\rf_model.joblib
PS C:\Users\W0024618\Desktop\ai-employee-security\src> 
