
// File: SwipeData/employee-ai-insights/server.js
const express = require('express');
const cors = require('cors');
const path = require('path');

const employeeRoutes = require('./routes/employeeRoutes');
const liveRt = require('./routes/liveOccupancyRoutes');

const app = express();

// Middleware
app.use(cors());
app.use(express.json());

// API Routes
app.use('/api', employeeRoutes);
app.use('/api', liveRt);  // GET /api/live-occupancy

// Serve React build from SwipeData/client/build
const buildPath = path.join(__dirname, '..', 'client', 'build');
app.use(express.static(buildPath));

// All other requests send back React’s index.html
app.get('*', (req, res) => {
  res.sendFile(path.join(buildPath, 'index.html'));
});

// Start server
const PORT = process.env.PORT || 5000;
app.listen(PORT, () => {
  console.log(`Server running at http://localhost:${PORT}`);
});







// src/services/api.js
import axios from 'axios';

const API_URL = '/api/live-occupancy';  
// Using a relative path — the Express server will proxy or serve this.

export async function fetchOccupancyData() {
  const resp = await axios.get(API_URL);
  return resp.data;
}



import React, { useEffect, useState } from 'react';
import { fetchOccupancyData } from './services/api';



cd ..        (to get back to swipeData/client)
set NODE_OPTIONS=--openssl-legacy-provider
npm run build










import React, { useEffect, useState } from 'react';
import { fetchOccupancyData } from './services/api';
import SummaryChart from './components/SummaryChart';
import ZoneDetailsTable from './components/ZoneDetailsTable';
import 'bootstrap/dist/css/bootstrap.min.css';

function App() {
  const [data, setData] = useState(null);

  useEffect(() => {
    const interval = setInterval(async () => {
      const newData = await fetchOccupancyData();
      setData(newData);
    }, 5000);

    return () => clearInterval(interval);
  }, []);

  if (!data) return <div className="text-center mt-5">Loading...</div>;

  return (
    <div className="container mt-4">
      <h2 className="text-center mb-4">Live Employee Occupancy Dashboard</h2>
      <SummaryChart summary={data.summary} />
      <ZoneDetailsTable details={data.details} />
    </div>
  );
}

export default App;





import React from 'react';
import {
  BarChart,
  Bar,
  XAxis,
  YAxis,
  Tooltip,
  CartesianGrid,
  ResponsiveContainer
} from 'recharts';

const SummaryChart = ({ summary }) => (
  <div className="mb-5">
    <h4>Zone-wise Occupancy</h4>
    <ResponsiveContainer width="100%" height={300}>
      <BarChart data={summary}>
        <CartesianGrid strokeDasharray="3 3" />
        <XAxis dataKey="zone" />
        <YAxis allowDecimals={false} />
        <Tooltip />
        <Bar dataKey="count" fill="#007bff" />
      </BarChart>
    </ResponsiveContainer>
  </div>
);

export default SummaryChart;





import React from 'react';
import { Accordion, Table } from 'react-bootstrap';

const ZoneDetailsTable = ({ details }) => (
  <div>
    <h4>Details by Zone</h4>
    <Accordion defaultActiveKey="0">
      {Object.entries(details).map(([zone, entries], index) => (
        <Accordion.Item eventKey={index.toString()} key={zone}>
          <Accordion.Header>
            {zone} – {entries.length} People
          </Accordion.Header>
          <Accordion.Body>
            <Table striped bordered hover responsive>
              <thead>
                <tr>
                  <th>Swipe Time</th>
                  <th>Employee ID</th>
                  <th>Name</th>
                  <th>Card Number</th>
                  <th>Personnel Type</th>
                </tr>
              </thead>
              <tbody>
                {entries.map((entry, i) => (
                  <tr key={i}>
                    <td>{entry.Swipe_Time}</td>
                    <td>{entry.EmployeeID}</td>
                    <td>{entry.ObjectName1}</td>
                    <td>{entry.CardNumber}</td>
                    <td>{entry.PersonnelType}</td>
                  </tr>
                ))}
              </tbody>
            </Table>
          </Accordion.Body>
        </Accordion.Item>
      ))}
    </Accordion>
  </div>
);

export default ZoneDetailsTable;


cd client
set NODE_OPTIONS=--openssl-legacy-provider
npm run build





// client/package.json
{
  "scripts": {
    // …
    "build": "set \"NODE_OPTIONS=--openssl-legacy-provider\" && react-scripts build"
  }
}


set NODE_OPTIONS=--openssl-legacy-provider
npm run build




const express = require('express');
const cors = require('cors');
const path = require('path');

const employeeRoutes = require('./routes/employeeRoutes');
const liveRt = require('./routes/liveOccupancyRoutes');

const app = express();

// Middleware
app.use(cors());
app.use(express.json());

// API Routes
app.use('/api', employeeRoutes);
app.use('/api', liveRt);  // now GET /api/live-occupancy

// Serve frontend static files
const buildPath = path.join(__dirname, 'client', 'build');
app.use(express.static(buildPath));

// Serve index.html for unmatched routes (important for React Router)
app.get('*', (req, res) => {
  res.sendFile(path.join(buildPath, 'index.html'));
});

// Start server
const PORT = 5000;
app.listen(PORT, () => {
  console.log(`Server running at http://localhost:${PORT}`);
});









raed below Server.js (backend File) So give me Updated js file for serve Frontend build


const express = require('express');
const cors = require('cors');
const employeeRoutes = require('./routes/employeeRoutes');
const doorZoneMap=require('./data/doorZoneMap');
const liveRt  = require('./routes/liveOccupancyRoutes');
const app = express();

app.use(cors());
app.use(express.json());

app.use('/api', employeeRoutes);
app.use('/api', liveRt);  // now GET /api/live-occupancynode 

const PORT = 5000;
app.listen(PORT, () => {
  console.log(`Server running at http://localhost:${PORT}`);
});
