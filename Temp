Read ablve door details .
issue is there some door has InDirection as well outDirection

also some door has only one reader in or out.

thats why counts are mismatch.


for Podium floor Swipe come from this door 

"APAC_IN_PUN_PODIUM_P-1 TURNSTILE",
 "APAC_IN_PUN_PODIUM_P-1 TURNSTILE 1-OUT DOOR",
 "APAC_IN_PUN_PODIUM_P-1 TURNSTILE 2 -OUT DOOR",
 "APAC_IN_PUN-PODIUM_P-1 TURNSTILE 3 -OUT DOOR",
"APAC_IN_PUN_PODIUM_P-1 TURNSTILE 4 -OUT DOOR"

if Above door and Swipe is InDirection the this is our "Reception Area"
if Above door and Swipe is OutDirection "then Employee left office .then remove count.
otherwise When swipe in and out swipe come but here zone is not mentioned then count their value 
in behalf of their previous Swipe door.


for Tower b
 "APAC_IN_PUN_TOWER B_LIFT LOBBY DOOR": "TOWER B Pune",
door is this and swipe direction is out then consider employee left office.
then remove count.
otherwise calculate count on as per previous or current zone.



Now Upgrade logic and give me updated file .
update carefully .




// data/doorZoneMap.js

const doorZoneMap = {
  "APAC_IN-PUN-PODIUM-RED-RECREATION AREA FIRE EXIT 1-DOOR": "Red Zone",
  "APAC_IN_PUN_PODIUM_RED_IDF ROOM-02-Restricted Door": "Red Zone",
  "APAC_IN-PUN-PODIUM-MAIN PODIUM LEFT ENTRY-DOOR": "Reception Area",
  "APAC_IN_PUN_PODIUM_MAIN PODIUM RIGHT ENTRY-DOOR": "Reception Area",
  "APAC_IN-PUN-PODIUM-RED-RECEPTION TO WS ENTRY 1-DOOR": "Red Zone",
  "APAC_IN_PUN_PODIUM_ST2 DOOR 1 (RED)": "Red Zone",
  "APAC_IN_PUN_PODIUM_RED_MAIN LIFT LOBBY ENTRY 1-DOOR": "Red Zone",
  "APAC_IN_PUN_PODIUM_ST 1-DOOR 1 (RED)": "Red Zone",
  "APAC_IN-PUN-PODIUM-YELLOW- SERVICE PASSAGE 1 ENTRY-DOOR": "YELLOW Zone",
  "APAC_IN-PUN-PODIUM-YELLOW-MAIN LIFT LOBBY-DOOR": "YELLOW Zone",
  "APAC_IN_PUN_PODIUM_ST2 DOOR 2 (YELLOW)": "YELLOW Zone",
  "APAC_IN_PUN_PODIUM_YELLOW_MDF Restricted Door": "YELLOW Zone",
  "APAC_IN_PUN_PODIUM_YELLOW_IT STORE ROOM-DOOR Restricted door": "YELLOW Zone",
  "APAC_IN_PUN_PODIUM_GSOC DOOR Restricted door": "GSOC",
  "APAC_IN_PUN_PODIUM_YELLOW_REPRO STORE-DOOR Restricted door": "YELLOW Zone",
  "APAC_IN_PUN_PODIUM_YELLOW_CONTROL PANEL ROOM-DOOR Restricted door": "YELLOW Zone",
  "APAC_IN_PUN_PODIUM_YELLOW_PREACTION ROOM-DOOR Restricted door": "YELLOW Zone",
  "APAC_IN_PUN_PODIUM_YELLOW_RECEPTION ENTRY-DOOR": "YELLOW Zone",
  "APAC_IN_PUN_PODIUM_YELLOW_TESTING LAB-DOOR Restricted door": "YELLOW Zone",
  "APAC_IN_PUN_PODIUM_GREEN-_IDF ROOM 1-Restricted Door": "GREEN Zone",
  "APAC_IN_PUN_PODIUM_GREEN_UPS ENTRY 1-DOOR Restricted door": "GREEN Zone",
  "APAC_IN_PUN_PODIUM_GREEN_UPS ENTRY 2-DOOR Restricted door": "GREEN Zone",
  "APAC_IN_PUN_PODIUM_GREEN_LOCKER HR STORE 3-DOOR Restricted door": "GREEN Zone",
  "APAC_IN_PUN_PODIUM_ST4 DOOR 2 (GREEN)": "GREEN Zone",
  "APAC_IN_PUN_PODIUM_ST4 DOOR 1 (ORANGE)": "ORANGE Zone",
  "APAC_IN_PUN_PODIUM_GREEN-MAIN LIFT LOBBY-DOOR": "GREEN Zone",
  "APAC_IN_PUN_PODIUM_ST3 DOOR 2 (GREEN)": "GREEN Zone",
  "APAC_IN_PUN_PODIUM_GREEN_RECEPTION ENTRY-DOOR": "GREEN Zone",
  "APAC_IN_PUN_PODIUM_ORANGE_RECEPTION ENTRY-DOOR": "ORANGE Zone",
  "APAC_IN_PUN_PODIUM_ST3_DOOR 1 (ORANGE)": "ORANGE Zone",
  "APAC_IN_PUN_PODIUM_ORANGE_MAIN LIFT LOBBY-DOOR": "ORANGE Zone",
  "APAC_IN_PUN_PODIUM_ORANGE-IDF ROOM 3-Restricted Door": "ORANGE Zone",
  "APAC_IN_PUN_PODIUM_ORANGE_KITCHENETTE FIRE EXIT-DOOR": "ORANGE Zone",
  "APAC_IN_PUN_2NDFLR_IDF ROOM_10:05:86 Restricted Door": "2nd Floor Pune",
  "APAC_IN_PUN_2NDFLR_UPS/ELEC ROOM Restricted Door_10:05:FE": "2nd Floor Pune",
  "APAC_IN_PUN_2NDFLR_RECPTION TO WORKSTATION DOOR_10:05:4B": "2nd Floor Pune",
  "APAC_IN_PUN_2NDFLR_LIFTLOBBY TO RECEPTION EMTRY DOOR_10:05:74": "2nd Floor Pune",
  "APAC_IN_PUN_2NDFLR_LIFTLOBBY TO WORKSTATION DOOR_10:05:F0": "2nd Floor Pune",
  "APAC_IN_PUN_PODIUM_RED_RECEPTION TO WS ENTRY 1-DOOR NEW": "Red Zone",
  "APAC_IN_PUN_PODIUM_YELLOW_MAIN LIFT LOBBY-DOOR NEW": "YELLOW Zone",
  "APAC_IN_PUN_PODIUM_ST 1 DOOR 2 (YELLOW)": "YELLOW Zone",
  "APAC_IN_PUN_PODIUM_ORANGE_KITCHENETTE FIRE EXIT-DOOR NEW": "ORANGE Zone",
  "APAC_IN_PUN_PODIUM_YELLOW_FIRE EXIT 1-DOOR NEW": "YELLOW Zone",
  "APAC_IN_PUN_PODIUM_RED_RECREATION AREA FIRE EXIT 1-DOOR NEW": "Red Zone",
  "APAC_IN_PUN_PODIUM_MAIN PODIUM RIGHT ENTRY-DOOR NEW": "Reception Area",
  "APAC_IN_PUN_PODIUM_MAIN PODIUM LEFT ENTRY-DOOR NEW": "Reception Area",
  "APAC_IN_PUN_TOWER B_MAIN RECEPTION DOOR": "TOWER B Pune",
  "APAC_IN_PUN_TOWER B_LIFT LOBBY DOOR": "TOWER B Pune",
  "APAC_IN_PUN_TOWER B_ST6_GYM SIDE DOOR": "TOWER B Pune",
  "APAC_IN_PUN_TOWER B_ST6_WKS SIDE DOOR": "TOWER B Pune",
  "APAC_IN_PUN_TOWER B_ST5_KAPIL DEV DOOR": "TOWER B Pune",
  "APAC_IN_PUN_TOWER B_ST5_WKS SIDE DOOR": "TOWER B Pune",
  "APAC_IN_PUN_TOWER B_RECEPTION LEFT DOOR": "TOWER B Pune",
  "APAC_IN_PUN_TOWER B_RECEPTION RIGHT DOOR": "TOWER B Pune",
  "APAC_IN_PUN_TOWER B_ST5_FIRE EXIT DOOR": "TOWER B Pune",
  "APAC_IN_PUN_TOWER B_ST6_FIRE EXIT DOOR": "TOWER B Pune",
  "APAC_IN_PUN_TOWER B_IBMS ROOM": "TOWER B Pune",
  "APAC_IN_PUN_TOWER B_UPS ROOM": "TOWER B Pune",
  "APAC_IN_PUN_TOWER B_MDF ROOM": "TOWER B Pune",
  "APAC_IN_PUN_TOWER B_PAC ROOM": "TOWER B Pune",
  "APAC_IN_PUN_TOWER B_IT STORE ROOM": "TOWER B Pune",
  "APAC_IN_PUN_TOWER B_GYM ROOM": "TOWER B Pune"
};

// Special door prefixes for dynamic direction-based mapping
const turnstilePrefixList = [
  "APAC_IN_PUN_PODIUM_P-1 TURNSTILE",
  "APAC_IN_PUN_PODIUM_P-1 TURNSTILE 1-OUT DOOR",
  "APAC_IN_PUN_PODIUM_P-1 TURNSTILE 2 -OUT DOOR",
  "APAC_IN_PUN-PODIUM_P-1 TURNSTILE 3 -OUT DOOR",
  "APAC_IN_PUN_PODIUM_P-1 TURNSTILE 4 -OUT DOOR"
];

function mapDoorToZone(door, direction) {
  // Direction‐based rule for turnstiles
  if (turnstilePrefixList.some(prefix => door.startsWith(prefix))) {
    return direction === 'InDirection' ? 'Reception Area' : null;
  }

  // exact match, or fall back to the literal key lookup
  return doorZoneMap[door] || 'Unknown Zone';
}

module.exports = mapDoorToZone;


