const fs = require('fs');
const path = require('path');
const xlsx = require('xlsx');

// Load Excel file
const inputFilePath = path.join(__dirname, '../data/punedoor.xlsx');
const outputFilePath = path.join(__dirname, '../data/doorZoneMap.js');

const workbook = xlsx.readFile(inputFilePath);
const sheetName = workbook.SheetNames[0];
const sheet = workbook.Sheets[sheetName];
const data = xlsx.utils.sheet_to_json(sheet, { defval: '' });

const map = {};

data.forEach((row, index) => {
  console.log(`Row ${index + 2}:`, row); // Show full row

  const door = row['Name']?.trim();
  const inDir = row['IN Direction']?.trim();
  const inZone = row['Zone']?.trim();

  const outDir = row['OUT Direction']?.trim();
  const outZone = row['Zone ']?.trim(); // Note the space

  if (!door) return;

  if (inDir && inZone) {
    map[`${door}___InDirection`] = inZone;
  }

  if (outDir && outZone) {
    map[`${door}___OutDirection`] = outZone;
  }
});

const fileContent = `// Auto-generated from punedoor.xlsx

const doorZoneMap = ${JSON.stringify(map, null, 2)};

module.exports = doorZoneMap;
`;

fs.writeFileSync(outputFilePath, fileContent, 'utf8');
console.log(`✅ doorZoneMap.js generated with ${Object.keys(map).length} entries.`);













When i run this generateDoorZoneMap.js file 

const fs = require('fs');
const path = require('path');
const xlsx = require('xlsx');

// Path to your Excel file
const inputFilePath = path.join(__dirname, '../data/punedoor.xlsx');
// Path to output JS file
const outputFilePath = path.join(__dirname, '../data/doorZoneMap.js');

const workbook = xlsx.readFile(inputFilePath);
const sheetName = workbook.SheetNames[0];
const sheet = workbook.Sheets[sheetName];
const data = xlsx.utils.sheet_to_json(sheet);

const map = {};
// Add inside data.forEach
data.forEach((row, index) => {
  console.log(`Row ${index + 2}:`, row); // Debug print

  const door = row['Door Name']?.trim();
  const inZone = row['IN Direction Zone Name']?.trim();
  const outZone = row['OUT Direction Zone Name']?.trim();

  if (!door) return;

  if (inZone) {
    map[`${door}___InDirection`] = inZone;
  }

  if (outZone) {
    map[`${door}___OutDirection`] = outZone;
  }
});


const fileContent = `// Auto-generated from punedoor.xlsx

const doorZoneMap = ${JSON.stringify(map, null, 2)};

module.exports = doorZoneMap;
`;

fs.writeFileSync(outputFilePath, fileContent, 'utf8');
console.log(`✅ doorZoneMap.js generated with ${Object.keys(map).length} entries.`);




We got this output.

PS C:\Users\W0024618\Desktop\swipeData\employee-ai-insights> node scripts/generateDoorZoneMap.js
>>
Row 2: {
  Name: 'APAC_IN_PUN_PODIUM_RED_IDF ROOM-02-Restricted Door',
  'IN Direction': 'IN',
  Zone: 'RED ZONE '
}
Row 3: {
  Name: 'APAC_IN_PUN_PODIUM_ST2 DOOR 1 (RED)',
  'IN Direction': 'IN',
  Zone: 'RED ZONE '
}
Row 4: {
  Name: 'APAC_IN_PUN_PODIUM_RED_MAIN LIFT LOBBY ENTRY 1-DOOR',
  'IN Direction': 'IN',
  Zone: 'RED ZONE ',
  'OUT Direction': 'OUT',
  'Zone ': 'Out of office'
}
Row 5: {
  Name: 'APAC_IN_PUN_PODIUM_ST 1-DOOR 1 (RED)',
  'IN Direction': 'IN',
  Zone: 'RED ZONE ',
  'OUT Direction': 'OUT',
  'Zone ': 'ST-1'
}

upto


}
Row 62: {
  Name: 'APAC_IN_PUN_TOWER B_GYM ROOM',
  'IN Direction': 'IN',
  Zone: 'Tower B'
}
✅ doorZoneMap.js generated with 0 entries.


 and  file


// Auto-generated from punedoor.xlsx

const doorZoneMap = {};

module.exports = doorZoneMap;
