node scripts/generateDenverDoorFloorMap.js



const fs = require('fs');
const path = require('path');
const xlsx = require('xlsx');

// 1. Load the workbook & first sheet
const filePath = path.join(__dirname, '..', 'data', 'doorDenver.xlsx');
const workbook = xlsx.readFile(filePath);
const sheet = workbook.Sheets[workbook.SheetNames[0]];

// 2. Convert to JSON
const rows = xlsx.utils.sheet_to_json(sheet);
if (!rows.length) {
  console.error('No rows found in doorDenver.xlsx');
  process.exit(1);
}
console.log(`Read ${rows.length} rows from doorDenver.xlsx`);

// 3. Build the door→floor map
const doorFloorMap = {};

// Excel column headers (adjust if your actual Excel file has different names)
const DOOR_COLUMN = 'Door Name';
const IN_DIR_COLUMN = 'IN Direction';
const IN_FLOOR_COLUMN = 'IN Floor';
const OUT_DIR_COLUMN = 'OUT Direction';
const OUT_FLOOR_COLUMN = 'OUT Floor';

rows.forEach((row, index) => {
  const rawDoor = String(row[DOOR_COLUMN] || '').trim();
  const inDir = String(row[IN_DIR_COLUMN] || '').trim();
  const inFloor = String(row[IN_FLOOR_COLUMN] || '').trim();
  const outDir = String(row[OUT_DIR_COLUMN] || '').trim();
  const outFloor = String(row[OUT_FLOOR_COLUMN] || '').trim();

  if (!rawDoor) {
    console.warn(`Skipping row ${index + 2} (missing Door Name)`);
    return;
  }

  const doorName = rawDoor.toUpperCase();

  if (inDir && inFloor) {
    doorFloorMap[`${doorName}___${inDir}`] = inFloor;
  }

  if (outDir && outFloor) {
    doorFloorMap[`${doorName}___${outDir}`] = outFloor;
  }
});

// 4. Generate output content
const outputPath = path.join(__dirname, '..', 'data', 'denverDoorFloorMap.js');
const content =
  `// Auto-generated from data/doorDenver.xlsx\n` +
  `module.exports = ${JSON.stringify(doorFloorMap, null, 2)};\n`;

// 5. Write file with overwrite mode
try {
  fs.writeFileSync(outputPath, content, { encoding: 'utf8', flag: 'w' });
  console.log('\n✅ Denver door-to-floor map written to:', outputPath);
  console.log('Total entries in map:', Object.keys(doorFloorMap).length);
} catch (err) {
  console.error('❌ Error writing file:', err.message);
}

// 6. Preview first few lines
console.log('\n--- Preview of exported map ---');
console.log(content.slice(0, 500));
console.log('--------------------------------');










const fs = require('fs');
const path = require('path');
const xlsx = require('xlsx');

// 1. Load Excel file
const filePath = path.join(__dirname, '..', 'data', 'doorDenver.xlsx');
const workbook = xlsx.readFile(filePath);
const sheet = workbook.Sheets[workbook.SheetNames[0]];
const rows = xlsx.utils.sheet_to_json(sheet);

if (!rows.length) {
  console.error('No rows found in doorDenver.xlsx');
  process.exit(1);
}

console.log(`Read ${rows.length} rows from doorDenver.xlsx`);

// 2. Build the door-to-floor map
const doorFloorMap = {};
rows.forEach(row => {
  const rawDoor = String(row['Door Name'] || '').trim();
  if (!rawDoor) return; // skip if door name is blank
  const doorName = rawDoor.toUpperCase();

  const inDir = String(row['IN Direction'] || '').trim();
  const inFloor = String(row['IN Floor'] || '').trim();
  if (inDir && inFloor) {
    doorFloorMap[`${doorName}___${inDir}`] = inFloor;
  }

  const outDir = String(row['OUT Direction'] || '').trim();
  const outFloor = String(row['OUT Floor'] || '').trim();
  if (outDir && outFloor) {
    doorFloorMap[`${doorName}___${outDir}`] = outFloor;
  }
});

// 3. Write result to JS file
const outputPath = path.join(__dirname, '..', 'data', 'denverDoorFloorMap.js');
const content = 
  `// Auto-generated from data/doorDenver.xlsx\n` +
  `module.exports = ${JSON.stringify(doorFloorMap, null, 2)};\n`;

fs.writeFileSync(outputPath, content, 'utf8');

console.log('✅ Denver door-to-floor map written to:', outputPath);
console.log('Total entries in map:', Object.keys(doorFloorMap).length);















// scripts/generateDenverDoorFloorMap.js

const fs = require('fs');
const path = require('path');
const xlsx = require('xlsx');

// 1. Load Excel file
const filePath = path.join(__dirname, '..', 'data', 'doorDenver.xlsx');
const workbook = xlsx.readFile(filePath);
const sheet = workbook.Sheets[workbook.SheetNames[0]];
const rows = xlsx.utils.sheet_to_json(sheet);

if (!rows.length) {
  console.error('No rows found in doorDenver.xlsx');
  process.exit(1);
}

console.log(`Read ${rows.length} rows from doorDenver.xlsx`);

// 2. Build the map
const doorFloorMap = {};
const DOOR_COLUMN = 'Door Name';
const IN_DIR_COLUMN = 'IN Direction';
const IN_FLOOR_COLUMN = 'IN Floor';
const OUT_DIR_COLUMN = 'OUT Direction';
const OUT_FLOOR_COLUMN = 'OUT Floor';

rows.forEach(row => {
  const rawDoor = String(row[DOOR_COLUMN] || '').trim();
  const doorName = rawDoor.toUpperCase();

  const inDirection = String(row[IN_DIR_COLUMN] || '').trim();
  const inFloor = String(row[IN_FLOOR_COLUMN] || '').trim();

  const outDirection = String(row[OUT_DIR_COLUMN] || '').trim();
  const outFloor = String(row[OUT_FLOOR_COLUMN] || '').trim();

  if (!doorName) {
    console.warn('Skipping row (missing Door Name):', row);
    return;
  }

  if (inDirection && inFloor) {
    doorFloorMap[`${doorName}___${inDirection}`] = inFloor;
  }

  if (outDirection && outFloor) {
    doorFloorMap[`${doorName}___${outDirection}`] = outFloor;
  }
});

// 3. Write output
const outputPath = path.join(__dirname, '..', 'data', 'denverDoorFloorMap.js');
const content =
  `// Auto-generated from data/doorDenver.xlsx\n` +
  `module.exports = ${JSON.stringify(doorFloorMap, null, 2)};\n`;

fs.writeFileSync(outputPath, content, 'utf8');

console.log('✅ Denver door-to-floor map written to:', outputPath);
console.log('Total entries in map:', Object.keys(doorFloorMap).length);






node scripts/generateDenverDoorFloorMap.js









// scripts/generateDenverDoorFloorMap.js

const fs = require('fs');
const path = require('path');
const xlsx = require('xlsx');

// 1. Load the workbook & first sheet
const filePath = path.join(__dirname, '..', 'data', 'doorDenver.xlsx');
const workbook = xlsx.readFile(filePath);
const sheet = workbook.Sheets[workbook.SheetNames[0]];

// 2. Convert to JSON
const rows = xlsx.utils.sheet_to_json(sheet);
if (!rows.length) {
  console.error('No rows found in doorDenver.xlsx');
  process.exit(1);
}
console.log(`Read ${rows.length} rows from doorDenver.xlsx`);

// 3. Build the door→floor map
const doorFloorMap = {};

// Column headers
const DOOR_COLUMN = 'Door Name';
const IN_DIR_COLUMN = 'IN Direction';
const IN_FLOOR_COLUMN = 'IN Floor';
const OUT_DIR_COLUMN = 'OUT Direction';
const OUT_FLOOR_COLUMN = 'OUT Floor';

rows.forEach(row => {
  const rawDoor = String(row[DOOR_COLUMN] || '').trim();
  const inDir = String(row[IN_DIR_COLUMN] || '').trim();
  const inFloor = String(row[IN_FLOOR_COLUMN] || '').trim();
  const outDir = String(row[OUT_DIR_COLUMN] || '').trim();
  const outFloor = String(row[OUT_FLOOR_COLUMN] || '').trim();

  if (!rawDoor) {
    console.warn('Skipping row (missing Door Name):', row);
    return;
  }

  const doorName = rawDoor.toUpperCase();

  if (inDir && inFloor) {
    doorFloorMap[`${doorName}___${inDir}`] = inFloor;
  }

  if (outDir && outFloor) {
    doorFloorMap[`${doorName}___${outDir}`] = outFloor;
  }
});

// 4. Write out the JS file
const outputPath = path.join(__dirname, '..', 'data', 'denverDoorFloorMap.js');
const content = 
  `// Auto-generated from data/doorDenver.xlsx\n` +
  `module.exports = ${JSON.stringify(doorFloorMap, null, 2)};\n`;

fs.writeFileSync(outputPath, content, 'utf8');

console.log('✅ Denver door-to-floor map written to:', outputPath);
console.log('Total entries in map:', Object.keys(doorFloorMap).length);









// scripts/generateDenverDoorFloorMap.js

const fs = require('fs');
const path = require('path');
const xlsx = require('xlsx');

// 1. Load the workbook & first sheet
const filePath = path.join(__dirname, '..', 'data', 'doorDenver.xlsx');
const workbook = xlsx.readFile(filePath);
const sheet = workbook.Sheets[workbook.SheetNames[0]];

// 2. Convert to JSON
const rows = xlsx.utils.sheet_to_json(sheet);
if (!rows.length) {
  console.error('No rows found in doorDenver.xlsx');
  process.exit(1);
}
console.log(`Read ${rows.length} rows from doorDenver.xlsx`);

// 3. Build the door→floor map
const doorFloorMap = {};

// Replace these with your actual column names in the Excel file
const DOOR_COLUMN = 'Door Name';
const IN_DIR_COLUMN = 'IN Direction';
const OUT_DIR_COLUMN = 'OUT Direction';
const FLOOR_COLUMN = 'Floor';

rows.forEach(row => {
  const rawDoor = String(row[DOOR_COLUMN] || '').trim();
  const inDirKey = String(row[IN_DIR_COLUMN] || '').trim();
  const outDirKey = String(row[OUT_DIR_COLUMN] || '').trim();
  const floor = String(row[FLOOR_COLUMN] || '').trim();

  if (!rawDoor || !floor) {
    console.warn('Skipping row (missing Door Name or Floor):', row);
    return;
  }

  const doorName = rawDoor.toUpperCase();

  if (inDirKey) {
    doorFloorMap[`${doorName}___${inDirKey}`] = floor;
  }
  if (outDirKey) {
    doorFloorMap[`${doorName}___${outDirKey}`] = floor;
  }
});

// 4. Write out the JS file
const outputPath = path.join(__dirname, '..', 'data', 'denverDoorFloorMap.js');
const content = 
  `// Auto-generated from data/doorDenver.xlsx\n` +
  `module.exports = ${JSON.stringify(doorFloorMap, null, 2)};\n`;

fs.writeFileSync(outputPath, content, 'utf8');

console.log('✅ Denver door-to-floor map written to:', outputPath);
console.log('Total entries in map:', Object.keys(doorFloorMap).length);

